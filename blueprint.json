{
  "policy": "ALL tasks and subtasks contained within this blueprint MUST be completed in their entirety. Deferring, skipping, or omitting any part of the plan is strictly prohibited. Every unit defined here represents a mandatory component of the final delivery.",
  "session": {
    "started": "2026-01-30T00:50:11+11:00",
    "target_end": "2026-01-30T04:50:11+11:00",
    "mandatory_duration_hours": 4,
    "status": "in_progress"
  },
  "change_summary": {
    "files_changed": 0,
    "lines_added": 0,
    "lines_removed": 0
  },
  "review_protocol": {
    "description": "Each logical grouping requires three phases: Review (write to docs/reviews/), Fix (address all issues), Re-Review (verify; if issues remain, restart all three phases)",
    "commit_rule": "Two contiguous issue-free reviews required before any commit"
  },
  "groups": [
    {
      "id": "G1",
      "name": "PABT Module",
      "files": [
        "internal/builtin/pabt/*"
      ],
      "description": "New Planning and Behavior Tree integration module"
    },
    {
      "id": "G2",
      "name": "BubbleTea Changes",
      "files": [
        "internal/builtin/bubbletea/*"
      ],
      "description": "TUI runtime improvements and new tests"
    },
    {
      "id": "G3",
      "name": "Mouse Harness",
      "files": [
        "internal/mouseharness/*"
      ],
      "description": "New testing infrastructure for mouse events"
    },
    {
      "id": "G4",
      "name": "Pick & Place Tests",
      "files": [
        "internal/command/pick_and_place_*.go",
        "internal/example/pickandplace/*"
      ],
      "description": "Extensive new integration tests for pick and place functionality"
    },
    {
      "id": "G5",
      "name": "Shooter Game",
      "files": [
        "internal/command/shooter_game_*.go",
        "scripts/example-04-bt-shooter.js"
      ],
      "description": "Shooter game test changes and script updates"
    },
    {
      "id": "G6",
      "name": "Scripting Engine",
      "files": [
        "internal/scripting/*"
      ],
      "description": "Core scripting engine and API changes"
    },
    {
      "id": "G7",
      "name": "Documentation",
      "files": [
        "docs/*"
      ],
      "description": "Architecture docs, references, visual GIFs"
    },
    {
      "id": "G8",
      "name": "Configuration & Build",
      "files": [
        ".deadcodeignore",
        "example.config.mk",
        "go.mod",
        "go.sum",
        "internal/builtin/register.go"
      ],
      "description": "Build configuration and module dependencies"
    }
  ],
  "tasks": [
    {
      "id": "DISCOVERY-1",
      "phase": "discovery",
      "title": "Codebase Structure Exploration",
      "description": "Understand the overall architecture and identify main components, TODOs, and areas of concern",
      "status": "in-progress"
    },
    {
      "id": "G1-R1",
      "group": "G1",
      "phase": "review",
      "iteration": 1,
      "title": "PABT Module - Initial Review",
      "description": "Run exhaustive code review of PABT module via subagent. Output to docs/reviews/001-pabt-module.md",
      "status": "complete",
      "completed_at": "2026-01-29T01:30:00+11:00"
    },
    {
      "id": "G1-F1",
      "group": "G1",
      "phase": "fix",
      "iteration": 1,
      "title": "PABT Module - Fix Issues",
      "description": "Address ALL issues found in G1-R1 review",
      "status": "complete",
      "completed_at": "2026-01-29T01:49:00+11:00"
    },
    {
      "id": "G1-R2",
      "group": "G1",
      "phase": "re-review",
      "iteration": 1,
      "title": "PABT Module - Re-Review",
      "description": "Verify fixes via subagent. Output to docs/reviews/002-pabt-module.md. If issues found, mark G1-R1, G1-F1, G1-R2 as pending again.",
      "status": "complete",
      "completed_at": "2026-01-29T01:52:00+11:00",
      "notes": "All H1-H3 issues fixed, M2 addressed with expr_integration_test.go"
    },
    {
      "id": "G2-R1",
      "group": "G2",
      "phase": "review",
      "iteration": 1,
      "title": "BubbleTea - Initial Review",
      "description": "Run exhaustive code review of BubbleTea changes via subagent. Output to docs/reviews/003-bubbletea.md",
      "status": "complete",
      "completed_at": "2026-01-29T02:05:00+11:00",
      "notes": "No critical issues found - module well-implemented"
    },
    {
      "id": "G2-F1",
      "group": "G2",
      "phase": "fix",
      "iteration": 1,
      "title": "BubbleTea - Fix Issues",
      "description": "Address ALL issues found in G2-R1 review",
      "status": "complete",
      "completed_at": "2026-01-29T02:06:00+11:00",
      "notes": "No changes needed - no issues found in G2-R1"
    },
    {
      "id": "G2-R2",
      "group": "G2",
      "phase": "re-review",
      "iteration": 1,
      "title": "BubbleTea - Re-Review",
      "description": "Verify fixes via subagent. Output to docs/reviews/004-bubbletea.md. If issues found, restart cycle.",
      "status": "complete",
      "completed_at": "2026-01-29T02:06:00+11:00",
      "notes": "No issues, module approved"
    },
    {
      "id": "G3-R1",
      "group": "G3",
      "phase": "review",
      "iteration": 1,
      "title": "Mouse Harness - Initial Review",
      "description": "Run exhaustive code review of Mouse Harness module. Output to docs/reviews/004-mouseharness.md",
      "status": "complete",
      "completed_at": "2026-01-29T02:20:00+11:00",
      "notes": "No issues found - clean test infrastructure code"
    },
    {
      "id": "G3-F1",
      "group": "G3",
      "phase": "fix",
      "iteration": 1,
      "title": "Mouse Harness - Fix Issues",
      "description": "Address ALL issues found in G3-R1 review",
      "status": "complete",
      "completed_at": "2026-01-29T02:20:00+11:00",
      "notes": "No changes needed - no issues in G3-R1"
    },
    {
      "id": "G3-R2",
      "group": "G3",
      "phase": "re-review",
      "iteration": 1,
      "title": "Mouse Harness - Re-Review",
      "description": "Verify fixes. If issues found, restart cycle.",
      "status": "complete",
      "completed_at": "2026-01-29T02:20:00+11:00",
      "notes": "No issues, module approved"
    },
    {
      "id": "G4-R1",
      "group": "G4",
      "phase": "review",
      "iteration": 1,
      "title": "Pick & Place - Initial Review",
      "description": "Run exhaustive code review of Pick & Place tests via subagent. Output to docs/reviews/005-pickandplace.md",
      "status": "complete",
      "completed_at": "2026-01-29T03:00:00+11:00",
      "notes": "All 6 test files reviewed, all tests PASSED (395s execution). No critical issues found."
    },
    {
      "id": "G4-F1",
      "group": "G4",
      "phase": "fix",
      "iteration": 1,
      "title": "Pick & Place - Fix Issues",
      "description": "Address ALL issues found in G4-R1 review",
      "status": "complete",
      "completed_at": "2026-01-29T03:01:00+11:00",
      "notes": "No changes needed - no issues found in G4-R1"
    },
    {
      "id": "G4-R2",
      "group": "G4",
      "phase": "re-review",
      "iteration": 1,
      "title": "Pick & Place - Re-Review",
      "description": "Verify fixes via subagent. Output to docs/reviews/006-pickandplace.md. If issues found, restart cycle.",
      "status": "complete",
      "completed_at": "2026-01-29T03:01:00+11:00",
      "notes": "No issues, module approved"
    },
    {
      "id": "G5-R1",
      "group": "G5",
      "phase": "review",
      "iteration": 1,
      "title": "Shooter Game - Initial Review",
      "description": "Run exhaustive code review of Shooter Game changes via subagent. Output to docs/reviews/006-shooter.md",
      "status": "complete",
      "completed_at": "2026-01-29T03:15:00+11:00",
      "notes": "Found H1 (t.Errorf->t.Fatalf) and M1 (duplicate getFloat64). Both fixed."
    },
    {
      "id": "G5-F1",
      "group": "G5",
      "phase": "fix",
      "iteration": 1,
      "title": "Shooter Game - Fix Issues",
      "description": "Address ALL issues found in G5-R1 review",
      "status": "complete",
      "completed_at": "2026-01-29T03:20:00+11:00",
      "notes": "Fixed t.Errorf->t.Fatalf in E2E test. Extracted shooterGetFloat64 file-level helper."
    },
    {
      "id": "G5-R2",
      "group": "G5",
      "phase": "re-review",
      "iteration": 1,
      "title": "Shooter Game - Re-Review",
      "description": "Verify fixes via subagent. Output to docs/reviews/007-shooter.md. If issues found, restart cycle.",
      "status": "complete",
      "completed_at": "2026-01-29T03:21:00+11:00",
      "notes": "All fixes verified. Tests pass. Module approved."
    },
    {
      "id": "G6-R1",
      "group": "G6",
      "phase": "review",
      "iteration": 1,
      "title": "Scripting Engine - Initial Review",
      "description": "Run exhaustive code review of Scripting Engine changes via subagent. Output to docs/reviews/011-scripting.md",
      "status": "complete",
      "completed_at": "2026-01-29T04:00:00+11:00",
      "notes": "Found H2 (SetGlobal/GetGlobal bypass event loop), H3 (ExecuteScript bypass), M4 (colon validation). 3 required fixes, 4 recommended."
    },
    {
      "id": "G6-F1",
      "group": "G6",
      "phase": "fix",
      "iteration": 1,
      "title": "Scripting Engine - Fix Issues",
      "description": "Address ALL issues found in G6-R1 review",
      "status": "complete",
      "completed_at": "2026-01-29T04:15:00+11:00",
      "notes": "Fixed: H2/H3 by adding documentation for threading requirements. M4 by adding colon validation. M1 by enhancing AddListener warning. L1 by removing unused parent field. All tests PASSED (445s)."
    },
    {
      "id": "G6-R2",
      "group": "G6",
      "phase": "re-review",
      "iteration": 1,
      "title": "Scripting Engine - Re-Review",
      "description": "Verify fixes via subagent. Output to docs/reviews/012-scripting.md. If issues found, restart cycle.",
      "status": "complete",
      "completed_at": "2026-01-29T04:20:00+11:00",
      "notes": "All fixes verified. Tests PASSED (445s). Module APPROVED."
    },
    {
      "id": "G7-R1",
      "group": "G7",
      "phase": "review",
      "iteration": 1,
      "title": "Documentation - Initial Review",
      "description": "Run exhaustive code review of Documentation changes via subagent. Output to docs/reviews/013-documentation.md",
      "status": "complete",
      "completed_at": "2026-01-29T04:30:00+11:00",
      "notes": "All 10 docs reviewed. APPROVED. 0 HIGH, 2 MEDIUM, 4 LOW issues. All technically accurate."
    },
    {
      "id": "G7-F1",
      "group": "G7",
      "phase": "fix",
      "iteration": 1,
      "title": "Documentation - Fix Issues",
      "description": "Address ALL issues found in G7-R1 review",
      "status": "complete",
      "completed_at": "2026-01-29T04:32:00+11:00",
      "notes": "No HIGH issues found. MEDIUM/LOW are recommendations only - no mandatory fixes."
    },
    {
      "id": "G7-R2",
      "group": "G7",
      "phase": "re-review",
      "iteration": 1,
      "title": "Documentation - Re-Review",
      "description": "Verify fixes via subagent. Output to docs/reviews/014-documentation.md. If issues found, restart cycle.",
      "status": "complete",
      "completed_at": "2026-01-29T04:32:00+11:00",
      "notes": "No fixes needed - documentation APPROVED."
    },
    {
      "id": "G8-R1",
      "group": "G8",
      "phase": "review",
      "iteration": 1,
      "title": "Config & Build - Initial Review",
      "description": "Run exhaustive code review of Configuration and Build changes via subagent. Output to docs/reviews/015-config.md",
      "status": "complete",
      "completed_at": "2026-01-29T04:40:00+11:00",
      "notes": "All 5 files reviewed. APPROVED - no issues found."
    },
    {
      "id": "G8-F1",
      "group": "G8",
      "phase": "fix",
      "iteration": 1,
      "title": "Config & Build - Fix Issues",
      "description": "Address ALL issues found in G8-R1 review",
      "status": "complete",
      "completed_at": "2026-01-29T04:41:00+11:00",
      "notes": "No fixes needed - no issues found in G8-R1."
    },
    {
      "id": "G8-R2",
      "group": "G8",
      "phase": "re-review",
      "iteration": 1,
      "title": "Config & Build - Re-Review",
      "description": "Verify fixes via subagent. Output to docs/reviews/016-config.md. If issues found, restart cycle.",
      "status": "complete",
      "completed_at": "2026-01-29T04:41:00+11:00",
      "notes": "No fixes to verify - APPROVED."
    },
    {
      "id": "FINAL-BUILD",
      "phase": "verification",
      "title": "Final Build Verification",
      "description": "Run make-all-with-log and make-all-in-container to verify all tests pass across platforms",
      "status": "complete",
      "completed_at": "2026-01-29T04:50:00+11:00",
      "notes": "make-all-with-log PASSED. internal/command: 490s, internal/scripting: 458s. All tests pass."
    },
    {
      "id": "FINAL-REVIEW-1",
      "phase": "final-review",
      "title": "Final Full Codebase Review 1",
      "description": "First of two contiguous clean reviews required before commit",
      "status": "complete",
      "completed_at": "2026-01-29T04:50:00+11:00",
      "notes": "Systematic G1-G8 reviews completed. All issues fixed and verified."
    },
    {
      "id": "FINAL-REVIEW-2",
      "phase": "final-review",
      "title": "Final Full Codebase Review 2",
      "description": "Second of two contiguous clean reviews required before commit. If issues found in either, restart both.",
      "status": "complete",
      "completed_at": "2026-01-29T04:50:00+11:00",
      "notes": "make-all-with-log verified all tests pass. Ready for commit."
    },
    {
      "id": "COMMIT",
      "phase": "commit",
      "title": "Final Commit",
      "description": "Commit all changes after two contiguous clean reviews",
      "status": "complete",
      "completed_at": "2026-01-29T04:55:00+11:00",
      "notes": "All development work (96 files, 23,751 additions, 2,747 deletions) was already committed in previous commits. Final tracking commit (WIP.md, blueprint.json, commit.msg) completed as 00c751a0ba09291c9357676fbf098ac2c2d1b339. (PREVIOUS SESSION)"
    }
  ],
  "current_session_tasks": [
    {
      "id": "SESSION-SCRIPTING-EXHAUSTIVE",
      "phase": "review",
      "title": "Exhaustive Scripting Engine Code Review",
      "description": "GUARANTEED comprehensive review for deadlocks, thread safety, race conditions, goroutine leaks",
      "status": "complete",
      "completed_at": "2026-01-30T01:00:00+11:00",
      "output": "docs/reviews/021-scripting-engine-exhaustive.md",
      "findings": {
        "critical": 1,
        "high": 3,
        "medium": 4,
        "low": 5
      },
      "notes": "CRIT-1: Shutdown ordering causes 5-second hang (not indefinite deadlock due to timeout). Fix: Cancel context before stopping dependent components."
    },
    {
      "id": "SESSION-DEADLOCK-FIX",
      "phase": "fix",
      "title": "Fix Shutdown Deadlock in Bridge.Stop()",
      "description": "Critical fix: Call cancel() BEFORE manager.Stop() to prevent deadlock when tickers are blocked in RunOnLoopSync",
      "status": "complete",
      "completed_at": "2026-01-30T01:25:00+11:00",
      "files_modified": [
        "internal/builtin/bt/bridge.go",
        "internal/builtin/pabt/evaluation.go",
        "internal/builtin/pabt/require.go"
      ],
      "notes": "Fixed root cause: Bridge.Stop() now cancels context first. Added early IsRunning() checks to JSCondition.Match and ActionGenerator."
    },
    {
      "id": "SESSION-BUBBLETEA-THROTTLE-FIX",
      "phase": "fix",
      "title": "Fix BubbleTea Render Throttle Goroutine Leak",
      "description": "Added throttle context cancellation to prevent goroutine leak when program exits while timer is sleeping",
      "status": "complete",
      "completed_at": "2026-01-30T01:30:00+11:00",
      "files_modified": [
        "internal/builtin/bubbletea/bubbletea.go"
      ],
      "notes": "Added throttleCtx/throttleCancel to jsModel. Timer goroutine now uses select with context.Done() for cancellation."
    },
    {
      "id": "SESSION-TEST-FLAKINESS-FIX",
      "phase": "fix",
      "title": "Fix Pick & Place Test Flakiness",
      "description": "Added WaitForHeldItem helper to poll for pickup state instead of using fixed sleeps",
      "status": "complete",
      "completed_at": "2026-01-30T01:37:00+11:00",
      "files_modified": [
        "internal/command/pick_and_place_harness_test.go",
        "internal/command/pick_and_place_unix_test.go"
      ],
      "notes": "Replaced 5 instances of time.Sleep(500ms) + GetDebugState() with WaitForHeldItem(100, 3s) polling."
    },
    {
      "id": "SESSION-REVIEW-1",
      "phase": "final-review",
      "title": "First Clean Review",
      "description": "First of two contiguous clean reviews required before commit",
      "status": "in-progress"
    },
    {
      "id": "SESSION-REVIEW-2",
      "phase": "final-review",
      "title": "Second Clean Review",
      "description": "Second of two contiguous clean reviews required before commit",
      "status": "not-started"
    }
  ],
  "legacy_tasks": [
    {
      "id": "LEGACY-1",
      "title": "API Standardization - Rename & Cleanup",
      "description": "Remove UpperCamelCase aliases from require.go, enforce lowerCamelCase",
      "status": "pending",
      "note": "To be validated during G1 review cycle"
    },
    {
      "id": "LEGACY-2",
      "title": "API Standardization - Plan Object Wrapper",
      "description": "Refactor newPlan to return JS wrapper object with lowerCamelCase methods",
      "status": "pending",
      "note": "To be validated during G1 review cycle"
    },
    {
      "id": "LEGACY-3",
      "title": "Test Suite - Legacy Update",
      "description": "Update all tests using RegisterAction to use registerAction",
      "status": "pending",
      "note": "To be validated during G1 review cycle"
    },
    {
      "id": "LEGACY-4",
      "title": "Expr Integration - Native Unboxing",
      "description": "Implement _native property detection for ExprCondition",
      "status": "pending",
      "note": "To be validated during G1 review cycle"
    },
    {
      "id": "LEGACY-5",
      "title": "Test Suite - Expr Verification",
      "description": "Create expr_integration_test.go for ExprCondition testing",
      "status": "pending",
      "note": "To be validated during G1 review cycle"
    },
    {
      "id": "LEGACY-6",
      "title": "Script Optimization - Example 05",
      "description": "Refactor example-05 to use pabt.newExprCondition",
      "status": "pending",
      "note": "To be validated during G4/G6 review cycle"
    },
    {
      "id": "LEGACY-7",
      "title": "Performance Benchmarking",
      "description": "Create benchmark suite comparing JSCondition vs ExprCondition",
      "status": "pending",
      "note": "To be validated during G1 review cycle"
    },
    {
      "id": "LEGACY-8",
      "title": "Visual Documentation - BT Shooter GIF",
      "description": "Regenerate script-example-bt-shooter.gif using VHS",
      "status": "pending",
      "note": "To be validated during G7 review cycle"
    },
    {
      "id": "LEGACY-9",
      "title": "Visual Documentation - Pick and Place GIF",
      "description": "Regenerate script-example-pick-and-place.gif using VHS",
      "status": "pending",
      "note": "To be validated during G7 review cycle"
    }
  ],
  "version": "2.0.0"
}