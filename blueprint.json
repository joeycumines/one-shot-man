{
  "meta": {
    "title": "PABT Expression Variant Refactor - Exhaustive Blueprint",
    "created": "2026-02-01",
    "author": "Takumi (匠)",
    "status": "ACTIVE",
    "priority": "HIGH"
  },
  "phases": [
    {
      "id": 1,
      "name": "Investigation Phase",
      "status": "in-progress",
      "description": "Investigate pabt system and identify all condition patterns across the codebase"
    }
  ],
  "tasks": [
    {
      "id": 1,
      "phase": 1,
      "title": "Read and analyze pabt Go source",
      "status": "completed",
      "description": "Read all Go source files in ./internal/builtin/pabt/ to understand condition evaluation modes and API",
      "deliverables": [
        "Understanding of JSCondition implementation",
        "Understanding of ExprCondition implementation",
        "Understanding of performance differences",
        "API surface documentation review"
      ]
    },
    {
      "id": 2,
      "phase": 1,
      "title": "Read and analyze example-05-pick-and-place.js",
      "status": "completed",
      "description": "Analyze the main example script to identify all JavaScript condition patterns in use",
      "deliverables": [
        "List of all condition patterns found in the script",
        "Frequency/count of each pattern type",
        "Locations where conditions are used (actions, goals, generators)"
      ]
    },
    {
      "id": 3,
      "phase": 1,
      "title": "Read PABT documentation",
      "status": "completed",
      "description": "Read docs/reference/pabt.md to understand official guidance and examples",
      "deliverables": [
        "Understanding of documented expr syntax",
        "Understanding of performance recommendations",
        "Understanding of when to use each variant"
      ]
    },
    {
      "id": 4,
      "phase": 1,
      "title": "Search workspace for all pabt usage",
      "status": "not-started",
      "description": "Search the entire workspace for files that use pabt to identify all places using conditions",
      "steps": [
        "Search for 'pabt.newAction' usage",
        "Search for 'match:' function definitions in pabt contexts",
        "Identify all example scripts using pabt",
        "Identify all test files using pabt",
        "Identify any internal Go code using condition patterns"
      ],
      "deliverables": [
        "Complete list of all files using pabt conditions",
        "Classification by: script/test/internal",
        "Count of total condition definitions across codebase"
      ]
    },
    {
      "id": 5,
      "phase": 1,
      "title": "Document all condition pattern types",
      "status": "not-started",
      "description": "Create comprehensive catalog of all match function patterns in use",
      "steps": [
        "Extract all unique match function patterns",
        "Categorize by: equality, comparison, boolean logic, complex",
        "Document which can be converted to expr vs require JS",
        "Create mapping table: JS pattern → Expr equivalent"
      ],
      "deliverables": [
        "Pattern catalog with examples",
        "Conversion guide for each pattern",
        "List of patterns that MUST stay JavaScript (complex logic)"
      ]
    },
    {
      "id": 6,
      "phase": 1,
      "title": "Create comprehensive refactor plan",
      "status": "not-started",
      "description": "Based on investigation results, create detailed plan for refactoring",
      "steps": [
        "Prioritize files by: impact, visibility, ease of conversion",
        "Define conversion strategy for each file",
        "Identify edge cases and special handling needed",
        "Plan test coverage for converted conditions"
      ],
      "deliverables": [
        "Detailed migration plan per file",
        "Risk assessment per file",
        "Test strategy to ensure no regressions"
      ]
    },
    {
      "id": 7,
      "phase": 1,
      "title": "Finalize investigation and update blueprint",
      "status": "not-started",
      "description": "Complete investigation phase and prepare for execution",
      "steps": [
        "Verify all tasks in this phase are done",
        "Complete WIP.md with all findings",
        "Update blueprint with detailed refactoring tasks",
        "Get approval to proceed to execution"
      ],
      "deliverables": [
        "Complete investigation documentation",
        "Exhaustive blueprint for all refactoring tasks",
        "Ready-to-execute task list for phases 2-4"
      ]
    }
  ]
}
